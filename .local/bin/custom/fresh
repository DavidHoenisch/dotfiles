#!/bin/bash

DOTFILES_GITHUB_REPO="https://github.com/DavidHoenisch/dotfiles.git"
OUTPUT_GIT_DIR="$HOME/dotfiles"
BIN_DIR="$HOME/.local/bin/custom"

# Install all the prereqs

declare -a prereq=("git" "stow" "base-devel")

for app in ${prereq[@]}; do
	sudo pacman -Sy --noconfirm "$app"
done

# Clone the dotfiles repo
git clone --depth=1 "$DOTFILES_GITHUB_REPO" "$OUTPUT_GIT_DIR"

(cd "$OUTPUT_GIT_DIR" && stow .)

(cd /tmp && git clone https://aur.archlinux.org/yay-bin.git && cd yay-bin && makepkg -si)

$BIN_DIR/gmanage restore
$BIN_DIR/mover install

pipx install gnome-extensions-cli --system-site-packages

cat $HOME/.local/bin/custom/gnome-extensions.txt | xargs gnome-extensions-cli install

$HOME/.config/gnome-settings/restore
